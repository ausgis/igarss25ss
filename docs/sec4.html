<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>4&nbsp; Geospatial artificial intelligence (GeoAI) for remote sensing data – IEEE IGARSS 2025 Summer School</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sec5.html" rel="next">
<link href="./sec3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-364982630eef5352dd1537128a8ed5cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sec4.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Geospatial artificial intelligence (GeoAI) for remote sensing data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">IEEE IGARSS 2025 Summer School</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ausgis/igarss25ss/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sec1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Remote sensing data collection</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sec2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Temporal analysis for remote sensing data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sec3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Spatial analysis for remote sensing data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sec4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Geospatial artificial intelligence (GeoAI) for remote sensing data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sec5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Practice and Example Datasets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sec6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Brief Introduction to Deep Learning and Transfer Learning</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#background-and-simple-examples-of-machine-learning" id="toc-background-and-simple-examples-of-machine-learning" class="nav-link active" data-scroll-target="#background-and-simple-examples-of-machine-learning"><span class="header-section-number">4.1</span> Background and Simple Examples of Machine Learning</a>
  <ul class="collapse">
<li><a href="#example-1-land-cover-classification-from-remote-sensing-imagery" id="toc-example-1-land-cover-classification-from-remote-sensing-imagery" class="nav-link" data-scroll-target="#example-1-land-cover-classification-from-remote-sensing-imagery"><span class="header-section-number">4.1.1</span> Example 1: Land Cover Classification from Remote Sensing Imagery</a></li>
  <li><a href="#example-2-spatial-prediction-of-vegetation-index" id="toc-example-2-spatial-prediction-of-vegetation-index" class="nav-link" data-scroll-target="#example-2-spatial-prediction-of-vegetation-index"><span class="header-section-number">4.1.2</span> Example 2: Spatial Prediction of Vegetation Index</a></li>
  </ul>
</li>
  <li>
<a href="#geoai-for-spatial-prediction-of-future-bushfire" id="toc-geoai-for-spatial-prediction-of-future-bushfire" class="nav-link" data-scroll-target="#geoai-for-spatial-prediction-of-future-bushfire"><span class="header-section-number">4.2</span> GeoAI for spatial prediction of future bushfire</a>
  <ul class="collapse">
<li><a href="#future-climate-data-collection" id="toc-future-climate-data-collection" class="nav-link" data-scroll-target="#future-climate-data-collection"><span class="header-section-number">4.2.1</span> Future climate data collection</a></li>
  <li><a href="#geoai-modelling" id="toc-geoai-modelling" class="nav-link" data-scroll-target="#geoai-modelling"><span class="header-section-number">4.2.2</span> GeoAI modelling</a></li>
  <li><a href="#model-validation" id="toc-model-validation" class="nav-link" data-scroll-target="#model-validation"><span class="header-section-number">4.2.3</span> Model validation</a></li>
  <li><a href="#spatial-prediction" id="toc-spatial-prediction" class="nav-link" data-scroll-target="#spatial-prediction"><span class="header-section-number">4.2.4</span> Spatial prediction</a></li>
  </ul>
</li>
  <li><a href="#analysing-future-bushfire-patterns" id="toc-analysing-future-bushfire-patterns" class="nav-link" data-scroll-target="#analysing-future-bushfire-patterns"><span class="header-section-number">4.3</span> Analysing future bushfire patterns</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Geospatial artificial intelligence (GeoAI) for remote sensing data</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="background-and-simple-examples-of-machine-learning" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="background-and-simple-examples-of-machine-learning">
<span class="header-section-number">4.1</span> Background and Simple Examples of Machine Learning</h2>
<p>Machine learning (ML) methods have gained popularity in geospatial research due to their ability to model nonlinear relationships from high-dimensional data. One recent development is <strong>GPBoost</strong>, which integrates tree boosting with Gaussian processes to model both fixed effects and spatial (or other structured) random effects.</p>
<section id="example-1-land-cover-classification-from-remote-sensing-imagery" class="level3" data-number="4.1.1"><h3 data-number="4.1.1" class="anchored" data-anchor-id="example-1-land-cover-classification-from-remote-sensing-imagery">
<span class="header-section-number">4.1.1</span> Example 1: Land Cover Classification from Remote Sensing Imagery</h3>
<p>Satellite images contain multispectral reflectance values across space. GPBoost can be used to classify land cover by combining decision tree boosting (e.g., LightGBM) with a Gaussian Process that accounts for spatial autocorrelation between nearby pixels.</p>
</section><section id="example-2-spatial-prediction-of-vegetation-index" class="level3" data-number="4.1.2"><h3 data-number="4.1.2" class="anchored" data-anchor-id="example-2-spatial-prediction-of-vegetation-index">
<span class="header-section-number">4.1.2</span> Example 2: Spatial Prediction of Vegetation Index</h3>
<p>Normalized Difference Vegetation Index (NDVI) values derived from remote sensing data often show spatial dependence. GPBoost allows prediction by combining covariates (e.g., elevation, temperature) with spatial random effects.</p>
</section></section><section id="geoai-for-spatial-prediction-of-future-bushfire" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="geoai-for-spatial-prediction-of-future-bushfire">
<span class="header-section-number">4.2</span> GeoAI for spatial prediction of future bushfire</h2>
<section id="future-climate-data-collection" class="level3" data-number="4.2.1"><h3 data-number="4.2.1" class="anchored" data-anchor-id="future-climate-data-collection">
<span class="header-section-number">4.2.1</span> Future climate data collection</h3>
<div class="callout callout-style-default callout-tip callout-titled" title="Aim">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Aim
</div>
</div>
<div class="callout-body-container callout-body">
<p>We separately collected future climate datasets of temperature and precipitation for the time period 2021–2040 from WorldClim. The previous 2024 data will be used for model training, followed by predicting bushfire burn areas for the time period 2021–2040.</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="Description of steps">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Description of steps
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Download WorldClim future climate datasets of temperature and precipitation for the time period 2021–2040.</li>
<li>Preprocess the downloaded future climate data and organize it into vector format for subsequent predictions.</li>
</ol>
</div>
</div>
<p>The data is downloaded from the WorldClim website and stored in the <code>./data/4. GeoAI Modeling/</code> directory, with period 2041-2060, GCM：ACCESS-CM2, scenarios:ssp585 (Links:<a href="https://www.worldclim.org/data/cmip6/cmip6_clim30s.html" class="uri">https://www.worldclim.org/data/cmip6/cmip6_clim30s.html</a>) .</p>
</section><section id="geoai-modelling" class="level3" data-number="4.2.2"><h3 data-number="4.2.2" class="anchored" data-anchor-id="geoai-modelling">
<span class="header-section-number">4.2.2</span> GeoAI modelling</h3>
<div class="callout callout-style-default callout-tip callout-titled" title="Aim">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Aim
</div>
</div>
<div class="callout-body-container callout-body">
<p>The step uses the gpboost model to fit temperature and precipitation data in 2024 for the next step of spatial prediction.</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="Description of steps">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Description of steps
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Load necessary libraries and data.</li>
<li>Build the GPBoost model using the data processed in Section 3.</li>
<li>You can also explore traditional machine learning models using the <a href="https://topepo.github.io/caret/"><code>caret</code></a> package.</li>
</ol>
</div>
</div>
<p>See <a href="https://towardsdatascience.com/tree-boosting-for-spatial-data-789145d6d97d/?sk=4f9924d378dbb517e883fc9c612c34f1">here</a> for more details about the gpboost model on spatio-temporal data.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">d24</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="st">'./data/3. Spatial analysis/burnedarea_2024.shp'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">d24</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pre"</span>,<span class="st">"tem"</span>,<span class="st">"burned"</span>,<span class="st">"geometry"</span><span class="op">)</span></span>
<span><span class="va">d24</span></span>
<span><span class="co"># Simple feature collection with 644 features and 3 fields</span></span>
<span><span class="co"># Geometry type: POLYGON</span></span>
<span><span class="co"># Dimension:     XY</span></span>
<span><span class="co"># Bounding box:  xmin: 129 ymin: -14.9 xmax: 131 ymax: -13.3</span></span>
<span><span class="co"># Geodetic CRS:  WGS 84</span></span>
<span><span class="co"># # A tibble: 644 × 4</span></span>
<span><span class="co">#     pre   tem burned                                        geometry</span></span>
<span><span class="co">#   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;                                   &lt;POLYGON [°]&gt;</span></span>
<span><span class="co"># 1  28.0 1893.   1250 ((130 -13.3, 130 -13.3, 130 -13.3, 130 -13.3, …</span></span>
<span><span class="co"># 2  28.0 1856.   1529 ((130 -13.3, 130 -13.3, 130 -13.3, 130 -13.3, …</span></span>
<span><span class="co"># 3  28.0 1888.   2203 ((130 -13.3, 130 -13.3, 130 -13.3, 130 -13.3, …</span></span>
<span><span class="co"># 4  28.0 1884.   1289 ((131 -13.3, 131 -13.3, 131 -13.3, 131 -13.3, …</span></span>
<span><span class="co"># 5  28.0 1865.   4247 ((131 -13.3, 131 -13.3, 131 -13.3, 131 -13.3, …</span></span>
<span><span class="co"># 6  28.0 1873.   1991 ((131 -13.3, 131 -13.3, 131 -13.3, 131 -13.3, …</span></span>
<span><span class="co"># # ℹ 638 more rows</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fabsig/GPBoost">gpboost</a></span><span class="op">)</span></span>
<span><span class="va">gp_model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gpboost/man/GPModel.html">GPModel</a></span><span class="op">(</span>gp_coords <span class="op">=</span> <span class="fu">sdsfun</span><span class="fu">::</span><span class="fu"><a href="https://stscl.github.io/sdsfun/reference/sf_coordinates.html">sf_coordinates</a></span><span class="op">(</span><span class="va">d24</span><span class="op">)</span>, </span>
<span>                   cov_function <span class="op">=</span> <span class="st">"exponential"</span><span class="op">)</span></span>
<span><span class="co"># Training</span></span>
<span><span class="va">bst</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gpboost/man/gpboost.html">gpboost</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">d24</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, </span>
<span>              label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">d24</span><span class="op">)</span><span class="op">[</span>,<span class="fl">3</span>,drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span>, </span>
<span>              gp_model <span class="op">=</span> <span class="va">gp_model</span>, objective <span class="op">=</span> <span class="st">"regression_l2"</span>, verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">bst</span></span>
<span><span class="co"># &lt;gpb.Booster&gt;</span></span>
<span><span class="co">#   Public:</span></span>
<span><span class="co">#     add_valid: function (data, name, valid_set_gp = NULL, use_gp_model_for_validation = TRUE) </span></span>
<span><span class="co">#     best_iter: -1</span></span>
<span><span class="co">#     best_score: NA</span></span>
<span><span class="co">#     current_iter: function () </span></span>
<span><span class="co">#     dump_model: function (num_iteration = NULL, feature_importance_type = 0L) </span></span>
<span><span class="co">#     eval: function (data, name, feval = NULL) </span></span>
<span><span class="co">#     eval_train: function (feval = NULL) </span></span>
<span><span class="co">#     eval_valid: function (feval = NULL) </span></span>
<span><span class="co">#     finalize: function () </span></span>
<span><span class="co">#     initialize: function (params = list(), train_set = NULL, modelfile = NULL, </span></span>
<span><span class="co">#     lower_bound: function () </span></span>
<span><span class="co">#     params: list</span></span>
<span><span class="co">#     predict: function (data, start_iteration = NULL, num_iteration = NULL, </span></span>
<span><span class="co">#     raw: NA</span></span>
<span><span class="co">#     record_evals: list</span></span>
<span><span class="co">#     reset_parameter: function (params, ...) </span></span>
<span><span class="co">#     rollback_one_iter: function () </span></span>
<span><span class="co">#     save: function () </span></span>
<span><span class="co">#     save_model: function (filename, start_iteration = NULL, num_iteration = NULL, </span></span>
<span><span class="co">#     save_model_to_string: function (start_iteration = NULL, num_iteration = NULL, feature_importance_type = 0L, </span></span>
<span><span class="co">#     set_train_data_name: function (name) </span></span>
<span><span class="co">#     to_predictor: function () </span></span>
<span><span class="co">#     update: function (train_set = NULL, fobj = NULL) </span></span>
<span><span class="co">#     upper_bound: function () </span></span>
<span><span class="co">#   Private:</span></span>
<span><span class="co">#     eval_names: NULL</span></span>
<span><span class="co">#     fixed_effect_train_loaded_from_file: NULL</span></span>
<span><span class="co">#     get_eval_info: function () </span></span>
<span><span class="co">#     gp_model: GPModel, R6</span></span>
<span><span class="co">#     gp_model_prediction_data_loaded_from_file: FALSE</span></span>
<span><span class="co">#     handle: gpb.Booster.handle</span></span>
<span><span class="co">#     has_gp_model: TRUE</span></span>
<span><span class="co">#     higher_better_inner_eval: NULL</span></span>
<span><span class="co">#     init_predictor: NULL</span></span>
<span><span class="co">#     inner_eval: function (data_name, data_idx, feval = NULL) </span></span>
<span><span class="co">#     inner_predict: function (idx) </span></span>
<span><span class="co">#     is_predicted_cur_iter: list</span></span>
<span><span class="co">#     label_loaded_from_file: NULL</span></span>
<span><span class="co">#     name_train_set: training</span></span>
<span><span class="co">#     name_valid_sets: list</span></span>
<span><span class="co">#     num_class: 1</span></span>
<span><span class="co">#     num_dataset: 1</span></span>
<span><span class="co">#     predict_buffer: list</span></span>
<span><span class="co">#     residual_loaded_from_file: NULL</span></span>
<span><span class="co">#     set_objective_to_none: FALSE</span></span>
<span><span class="co">#     train_set: gpb.Dataset, R6</span></span>
<span><span class="co">#     train_set_version: 1</span></span>
<span><span class="co">#     use_gp_model_for_validation: TRUE</span></span>
<span><span class="co">#     valid_sets: list</span></span>
<span><span class="co">#     valid_sets_gp: list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Example: Machine learning using caret</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepare non-spatial data</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">d24</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Train linear model with 5-fold CV</span></span>
<span><span class="va">ctrl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html">trainControl</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"cv"</span>, number <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_caret</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span></span>
<span>  <span class="va">burned</span> <span class="op">~</span> <span class="va">pre</span> <span class="op">+</span> <span class="va">tem</span>, </span>
<span>  data <span class="op">=</span> <span class="va">df</span>, </span>
<span>  method <span class="op">=</span> <span class="st">"lm"</span>, </span>
<span>  trControl <span class="op">=</span> <span class="va">ctrl</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_caret</span></span>
<span><span class="co"># Linear Regression </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># 644 samples</span></span>
<span><span class="co">#   2 predictor</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># No pre-processing</span></span>
<span><span class="co"># Resampling: Cross-Validated (5 fold) </span></span>
<span><span class="co"># Summary of sample sizes: 516, 515, 515, 516, 514 </span></span>
<span><span class="co"># Resampling results:</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#   RMSE  Rsquared  MAE </span></span>
<span><span class="co">#   4649  0.0659    3921</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Tuning parameter 'intercept' was held constant at a value of TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="model-validation" class="level3" data-number="4.2.3"><h3 data-number="4.2.3" class="anchored" data-anchor-id="model-validation">
<span class="header-section-number">4.2.3</span> Model validation</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Why model validation?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why model validation?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Model validation ensures that your model performs well on unseen data and helps avoid overfitting.</p>
</div>
</div>
<section id="common-validation-methods" class="level4"><h4 class="anchored" data-anchor-id="common-validation-methods">Common validation methods</h4>
<ul>
<li><strong>Train/test split</strong></li>
<li><strong>K-fold cross-validation</strong></li>
<li><strong>Leave-one-out cross-validation (LOOCV)</strong></li>
</ul></section><section id="common-evaluation-metrics" class="level4"><h4 class="anchored" data-anchor-id="common-evaluation-metrics">Common evaluation metrics</h4>
<ul>
<li>
<strong>RMSE</strong> (Root Mean Squared Error)<br>
</li>
<li>
<strong>MAE</strong> (Mean Absolute Error)<br>
</li>
<li>
<strong>R²</strong> (Coefficient of determination)</li>
</ul></section><section id="example-random-forest-model-with-rmse" class="level4"><h4 class="anchored" data-anchor-id="example-random-forest-model-with-rmse">Example: Random forest model with RMSE</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">model_rf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span></span>
<span>  <span class="va">burned</span> <span class="op">~</span> <span class="va">pre</span> <span class="op">+</span> <span class="va">tem</span>, </span>
<span>  data <span class="op">=</span> <span class="va">df</span>, </span>
<span>  method <span class="op">=</span> <span class="st">"rf"</span>, </span>
<span>  trControl <span class="op">=</span> <span class="va">ctrl</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"RMSE"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># note: only 1 unique complexity parameters in default grid. Truncating the grid to 1 .</span></span>
<span></span>
<span><span class="va">model_rf</span><span class="op">$</span><span class="va">results</span></span>
<span><span class="co">#   mtry RMSE Rsquared  MAE RMSESD RsquaredSD MAESD</span></span>
<span><span class="co"># 1    2 4449    0.175 3545    193     0.0224   131</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="spatial-prediction" class="level3" data-number="4.2.4"><h3 data-number="4.2.4" class="anchored" data-anchor-id="spatial-prediction">
<span class="header-section-number">4.2.4</span> Spatial prediction</h3>
<div class="callout callout-style-default callout-tip callout-titled" title="Aim">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Aim
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this step, the gpboost model constructed in the previous step is used to predict the burned area of 2030.</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="Description of steps">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Description of steps
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Read the futural climate data.</li>
<li>Process the data to use the gpboost model to predict.</li>
<li>Do spatial prediction by the gpboost model.</li>
</ol>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/">terra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">pref</span> <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html">rast</a></span><span class="op">(</span><span class="st">'./data/4. GeoAI Modeling/future_prec.tif'</span><span class="op">)</span></span>
<span><span class="va">pref</span></span>
<span><span class="co"># class       : SpatRaster </span></span>
<span><span class="co"># size        : 193, 154, 12  (nrow, ncol, nlyr)</span></span>
<span><span class="co"># resolution  : 0.00833, 0.00833  (x, y)</span></span>
<span><span class="co"># extent      : 129, 131, -14.9, -13.3  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co"># coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co"># source      : future_prec.tif </span></span>
<span><span class="co"># names       : wc2.1~ec_01, wc2.1~ec_02, wc2.1~ec_03, wc2.1~ec_04, wc2.1~ec_05, wc2.1~ec_06, ...</span></span>
<span><span class="va">pref</span> <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/app.html">app</a></span><span class="op">(</span><span class="va">pref</span>,fun <span class="op">=</span> <span class="st">"sum"</span>,na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html">names</a></span><span class="op">(</span><span class="va">pref</span><span class="op">)</span> <span class="op">=</span> <span class="st">"pre"</span></span>
<span><span class="va">pref</span></span>
<span><span class="co"># class       : SpatRaster </span></span>
<span><span class="co"># size        : 193, 154, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co"># resolution  : 0.00833, 0.00833  (x, y)</span></span>
<span><span class="co"># extent      : 129, 131, -14.9, -13.3  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co"># coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co"># source(s)   : memory</span></span>
<span><span class="co"># name        :  pre </span></span>
<span><span class="co"># min value   : 1109 </span></span>
<span><span class="co"># max value   : 1750</span></span>
<span></span>
<span><span class="va">temf</span> <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html">rast</a></span><span class="op">(</span><span class="st">'./data/4. GeoAI Modeling/future_tmax.tif'</span><span class="op">)</span></span>
<span><span class="va">temf</span></span>
<span><span class="co"># class       : SpatRaster </span></span>
<span><span class="co"># size        : 193, 154, 12  (nrow, ncol, nlyr)</span></span>
<span><span class="co"># resolution  : 0.00833, 0.00833  (x, y)</span></span>
<span><span class="co"># extent      : 129, 131, -14.9, -13.3  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co"># coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co"># source      : future_tmax.tif </span></span>
<span><span class="co"># names       : wc2.1~ax_01, wc2.1~ax_02, wc2.1~ax_03, wc2.1~ax_04, wc2.1~ax_05, wc2.1~ax_06, ...</span></span>
<span><span class="va">temf</span> <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/app.html">app</a></span><span class="op">(</span><span class="va">temf</span>,fun <span class="op">=</span> <span class="st">"mean"</span>,na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html">names</a></span><span class="op">(</span><span class="va">temf</span><span class="op">)</span> <span class="op">=</span> <span class="st">"tem"</span></span>
<span><span class="va">temf</span></span>
<span><span class="co"># class       : SpatRaster </span></span>
<span><span class="co"># size        : 193, 154, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co"># resolution  : 0.00833, 0.00833  (x, y)</span></span>
<span><span class="co"># extent      : 129, 131, -14.9, -13.3  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co"># coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co"># source(s)   : memory</span></span>
<span><span class="co"># name        :  tem </span></span>
<span><span class="co"># min value   : 33.9 </span></span>
<span><span class="co"># max value   : 37.4</span></span>
<span></span>
<span><span class="va">d30</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pref</span>,<span class="va">temf</span><span class="op">)</span></span>
<span><span class="va">d30</span> <span class="op">=</span> <span class="va">d30</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.polygons.html">as.polygons</a></span><span class="op">(</span>aggregate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">if_all</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,\<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d30</span></span>
<span><span class="co"># Simple feature collection with 16430 features and 2 fields</span></span>
<span><span class="co"># Geometry type: POLYGON</span></span>
<span><span class="co"># Dimension:     XY</span></span>
<span><span class="co"># Bounding box:  xmin: 129 ymin: -14.9 xmax: 131 ymax: -13.3</span></span>
<span><span class="co"># Geodetic CRS:  WGS 84</span></span>
<span><span class="co"># First 10 features:</span></span>
<span><span class="co">#     pre  tem                       geometry</span></span>
<span><span class="co"># 1  1739 34.6 POLYGON ((130 -13.3, 130 -1...</span></span>
<span><span class="co"># 2  1735 34.6 POLYGON ((130 -13.3, 130 -1...</span></span>
<span><span class="co"># 3  1745 34.6 POLYGON ((130 -13.3, 130 -1...</span></span>
<span><span class="co"># 4  1733 34.6 POLYGON ((130 -13.3, 130 -1...</span></span>
<span><span class="co"># 5  1732 34.6 POLYGON ((130 -13.3, 130 -1...</span></span>
<span><span class="co"># 6  1731 34.7 POLYGON ((130 -13.3, 130 -1...</span></span>
<span><span class="co"># 7  1725 34.8 POLYGON ((130 -13.3, 130 -1...</span></span>
<span><span class="co"># 8  1750 34.8 POLYGON ((130 -13.3, 130 -1...</span></span>
<span><span class="co"># 9  1741 34.8 POLYGON ((130 -13.3, 130 -1...</span></span>
<span><span class="co"># 10 1725 34.7 POLYGON ((130 -13.3, 130 -1...</span></span>
<span></span>
<span><span class="va">pred</span> <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/predict.html">predict</a></span><span class="op">(</span><span class="va">bst</span>, data <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/coerce.html">as.matrix</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="va">d30</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, </span>
<span>               gp_coords_pred <span class="op">=</span> <span class="fu">sdsfun</span><span class="fu">::</span><span class="fu"><a href="https://stscl.github.io/sdsfun/reference/sf_coordinates.html">sf_coordinates</a></span><span class="op">(</span><span class="va">d30</span><span class="op">)</span>, </span>
<span>               predict_var <span class="op">=</span> <span class="cn">TRUE</span>, pred_latent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d30</span><span class="op">$</span><span class="va">burned</span> <span class="op">=</span> <span class="va">pred</span><span class="op">$</span><span class="va">response_mean</span></span>
<span><span class="va">d30</span></span>
<span><span class="co"># Simple feature collection with 16430 features and 3 fields</span></span>
<span><span class="co"># Geometry type: POLYGON</span></span>
<span><span class="co"># Dimension:     XY</span></span>
<span><span class="co"># Bounding box:  xmin: 129 ymin: -14.9 xmax: 131 ymax: -13.3</span></span>
<span><span class="co"># Geodetic CRS:  WGS 84</span></span>
<span><span class="co"># First 10 features:</span></span>
<span><span class="co">#     pre  tem                       geometry burned</span></span>
<span><span class="co"># 1  1739 34.6 POLYGON ((130 -13.3, 130 -1...   3307</span></span>
<span><span class="co"># 2  1735 34.6 POLYGON ((130 -13.3, 130 -1...   3270</span></span>
<span><span class="co"># 3  1745 34.6 POLYGON ((130 -13.3, 130 -1...   3095</span></span>
<span><span class="co"># 4  1733 34.6 POLYGON ((130 -13.3, 130 -1...   3089</span></span>
<span><span class="co"># 5  1732 34.6 POLYGON ((130 -13.3, 130 -1...   3078</span></span>
<span><span class="co"># 6  1731 34.7 POLYGON ((130 -13.3, 130 -1...   3055</span></span>
<span><span class="co"># 7  1725 34.8 POLYGON ((130 -13.3, 130 -1...   3017</span></span>
<span><span class="co"># 8  1750 34.8 POLYGON ((130 -13.3, 130 -1...   2874</span></span>
<span><span class="co"># 9  1741 34.8 POLYGON ((130 -13.3, 130 -1...   2905</span></span>
<span><span class="co"># 10 1725 34.7 POLYGON ((130 -13.3, 130 -1...   2929</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="analysing-future-bushfire-patterns" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="analysing-future-bushfire-patterns">
<span class="header-section-number">4.3</span> Analysing future bushfire patterns</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Aim">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Aim
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this step, the predicted burned area of 2030 is used to analyse the future bushfire patterns.</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled" title="Description of steps">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Description of steps
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Visualise the predicted burned area of 2030.</li>
<li>Analyse the future bushfire patterns.</li>
</ol>
</div>
</div>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ausgis\.github\.io\/igarss25ss\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./sec3.html" class="pagination-link" aria-label="Spatial analysis for remote sensing data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Spatial analysis for remote sensing data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sec5.html" class="pagination-link" aria-label="Practice and Example Datasets">
        <span class="nav-page-text">Practice and Example Datasets</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb5" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Geospatial artificial intelligence (GeoAI) for remote sensing data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Background and Simple Examples of Machine Learning</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>Machine learning (ML) methods have gained popularity in geospatial research due to their ability to model nonlinear relationships from high-dimensional data. One recent development is **GPBoost**, which integrates tree boosting with Gaussian processes to model both fixed effects and spatial (or other structured) random effects.</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example 1: Land Cover Classification from Remote Sensing Imagery</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>Satellite images contain multispectral reflectance values across space. GPBoost can be used to classify land cover by combining decision tree boosting (e.g., LightGBM) with a Gaussian Process that accounts for spatial autocorrelation between nearby pixels.</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example 2: Spatial Prediction of Vegetation Index</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>Normalized Difference Vegetation Index (NDVI) values derived from remote sensing data often show spatial dependence. GPBoost allows prediction by combining covariates (e.g., elevation, temperature) with spatial random effects.</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">## GeoAI for spatial prediction of future bushfire </span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">### Future climate data collection</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Aim"}</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>We separately collected future climate datasets of temperature and precipitation for the time period 2021–2040 from WorldClim. The previous 2024 data will be used for model training, followed by predicting bushfire burn areas for the time period 2021–2040.</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution title="Description of steps"}</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Download WorldClim future climate datasets of temperature and precipitation for the time period 2021–2040.</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Preprocess the downloaded future climate data and organize it into vector format for subsequent predictions.</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>The data is downloaded from the WorldClim website and stored in the <span class="in">`./data/4. GeoAI Modeling/`</span> directory,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>with period 2041-2060, GCM：ACCESS-CM2, scenarios:ssp585 (Links:<span class="ot">&lt;https://www.worldclim.org/data/cmip6/cmip6_clim30s.html&gt;</span>) .</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="fu">### GeoAI modelling</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Aim"}</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>The step uses the gpboost model to fit temperature and precipitation data in 2024 for the next step of spatial prediction.</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution title="Description of steps"}</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Load necessary libraries and data.</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Build the GPBoost model using the data processed in Section 3.</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>You can also explore traditional machine learning models using the <span class="co">[</span><span class="ot">`caret`</span><span class="co">](https://topepo.github.io/caret/)</span> package.</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>See <span class="co">[</span><span class="ot">here</span><span class="co">](https://towardsdatascience.com/tree-boosting-for-spatial-data-789145d6d97d/?sk=4f9924d378dbb517e883fc9c612c34f1)</span> for more details about the gpboost model on spatio-temporal data.</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r , cache = FALSE, message = FALSE, echo=!knitr::is_latex_output()}</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>d24 <span class="ot">=</span> <span class="fu">read_sf</span>(<span class="st">'./data/3. Spatial analysis/burnedarea_2024.shp'</span>)</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(d24) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"pre"</span>,<span class="st">"tem"</span>,<span class="st">"burned"</span>,<span class="st">"geometry"</span>)</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>d24</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gpboost)</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>gp_model <span class="ot">=</span> <span class="fu">GPModel</span>(<span class="at">gp_coords =</span> sdsfun<span class="sc">::</span><span class="fu">sf_coordinates</span>(d24), </span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cov_function =</span> <span class="st">"exponential"</span>)</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Training</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>bst <span class="ot">=</span> <span class="fu">gpboost</span>(<span class="at">data =</span> <span class="fu">as.matrix</span>(sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>(d24)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]), </span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> <span class="fu">as.matrix</span>(sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>(d24)[,<span class="dv">3</span>,<span class="at">drop =</span> <span class="cn">FALSE</span>]), </span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>              <span class="at">gp_model =</span> gp_model, <span class="at">objective =</span> <span class="st">"regression_l2"</span>, <span class="at">verbose =</span> <span class="dv">0</span>)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>bst</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>Example: Machine learning using caret</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a><span class="in">```{r , cache = FALSE, message = FALSE, echo=!knitr::is_latex_output()}</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare non-spatial data</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>(d24)</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Train linear model with 5-fold CV</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">=</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>)</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>model_caret <span class="ot">=</span> <span class="fu">train</span>(</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>  burned <span class="sc">~</span> pre <span class="sc">+</span> tem, </span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df, </span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> ctrl</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>model_caret</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model validation</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Why model validation?"}</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>Model validation ensures that your model performs well on unseen data and helps avoid overfitting.</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Common validation methods</span></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Train/test split**</span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**K-fold cross-validation**</span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Leave-one-out cross-validation (LOOCV)**</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Common evaluation metrics</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**RMSE** (Root Mean Squared Error)  </span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**MAE** (Mean Absolute Error)  </span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**R²** (Coefficient of determination)</span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example: Random forest model with RMSE</span></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r , cache = FALSE, message = FALSE, echo=!knitr::is_latex_output()}</span></span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>model_rf <span class="ot">=</span> <span class="fu">train</span>(</span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>  burned <span class="sc">~</span> pre <span class="sc">+</span> tem, </span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df, </span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"rf"</span>, </span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> ctrl,</span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">"RMSE"</span></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>model_rf<span class="sc">$</span>results</span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a><span class="fu">### Spatial prediction</span></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Aim"}</span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>In this step, the gpboost model constructed in the previous step is used to predict the burned area of 2030.</span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution title="Description of steps"}</span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Read the futural climate data.</span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Process the data to use the gpboost model to predict.</span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Do spatial prediction by the gpboost model.</span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r , cache = FALSE, message = FALSE, echo=!knitr::is_latex_output()}</span></span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a>pref <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">'./data/4. GeoAI Modeling/future_prec.tif'</span>)</span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a>pref</span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>pref <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">app</span>(pref,<span class="at">fun =</span> <span class="st">"sum"</span>,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pref) <span class="ot">=</span> <span class="st">"pre"</span></span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>pref</span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>temf <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">'./data/4. GeoAI Modeling/future_tmax.tif'</span>)</span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>temf</span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a>temf <span class="ot">=</span> terra<span class="sc">::</span><span class="fu">app</span>(temf,<span class="at">fun =</span> <span class="st">"mean"</span>,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temf) <span class="ot">=</span> <span class="st">"tem"</span></span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a>temf</span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a>d30 <span class="ot">=</span> <span class="fu">c</span>(pref,temf)</span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a>d30 <span class="ot">=</span> d30 <span class="sc">|&gt;</span> </span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a>  terra<span class="sc">::</span><span class="fu">as.polygons</span>(<span class="at">aggregate =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>() <span class="sc">|&gt;</span> </span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(dplyr<span class="sc">::</span><span class="fu">if_all</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,\(.x) <span class="sc">!</span><span class="fu">is.na</span>(.x)))</span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>d30</span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">predict</span>(bst, <span class="at">data =</span> <span class="fu">as.matrix</span>(sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>(d30)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]), </span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a>               <span class="at">gp_coords_pred =</span> sdsfun<span class="sc">::</span><span class="fu">sf_coordinates</span>(d30), </span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a>               <span class="at">predict_var =</span> <span class="cn">TRUE</span>, <span class="at">pred_latent =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a>d30<span class="sc">$</span>burned <span class="ot">=</span> pred<span class="sc">$</span>response_mean</span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a>d30</span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analysing future bushfire patterns</span></span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Aim"}</span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a>In this step, the predicted burned area of 2030 is used to analyse the future bushfire patterns.</span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution title="Description of steps"}</span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Visualise the predicted burned area of 2030.</span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Analyse the future bushfire patterns.</span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a>:::</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>